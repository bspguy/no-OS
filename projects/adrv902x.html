
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>adrv902x no-OS Sample Poject &#8212; no-OS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contributing to no-OS" href="../contributing.html" />
    <link rel="prev" title="Evaluating the ADIS1657X Family" href="eval-adis1657x.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="adrv902x-no-os-sample-poject">
<h1>adrv902x no-OS Sample Poject<a class="headerlink" href="#adrv902x-no-os-sample-poject" title="Permalink to this headline">¶</a></h1>
<section id="supported-devices">
<h2>Supported Devices<a class="headerlink" href="#supported-devices" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.analog.com/ADRV9026">ADRV9026</a></p>
<p><a class="reference external" href="https://www.analog.com/ADRV9029">ADRV9029</a></p>
</section>
<section id="supported-carriers">
<h2>Supported Carriers<a class="headerlink" href="#supported-carriers" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.xilinx.com/ZCU102">ZCU102</a></p>
</section>
<section id="naming-conventions">
<h2>Naming Conventions<a class="headerlink" href="#naming-conventions" title="Permalink to this headline">¶</a></h2>
<p>This guide is a source of information for system engineers and software developers using the Analog Devices, Inc., ADRV902x
family of software defined radio transceivers. This family consists of the ADRV9026 integrated quad RF transceiver and the ADRV9029
integrated quad RF transceiver with digital predistortion (DPD) and crest factor reduction (CFR) capability.</p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Prior to building the project, the environment for the development of Xilinx projects must be set up. These are presented in the <em>Build Prerequisites</em> section of no-OS build guide available here: <a class="reference external" href="https://wiki.analog.com/resources/no-os/build">https://wiki.analog.com/resources/no-os/build</a>.</p>
</section>
<section id="building-and-running-the-project">
<h2>Building and Running the Project<a class="headerlink" href="#building-and-running-the-project" title="Permalink to this headline">¶</a></h2>
<p>The steps indicated at the following address have to be followed for building the project, for debugging, and running. These steps are adapted to the used platform and host OS: <a class="reference external" href="https://wiki.analog.com/resources/no-os/build">https://wiki.analog.com/resources/no-os/build</a>.</p>
<p>Currently, the project is only intended to be run on the <a class="reference external" href="https://www.xilinx.com/ZCU102">ZCU102</a> target, so the Xilinx procedure is to be followed.</p>
<ol class="arabic simple">
<li><p>Open a terminal and navigate to this project directory (if building on Windows, <cite>Git Bash</cite> has to be used).</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">-j</span></code> in order to build the project.</p></li>
</ol>
<p>A successful build should end with the following terminal output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>   text         data     bss     dec     hex filename
<span class="m">1213464</span>       <span class="m">368588</span> <span class="m">1239624</span> <span class="m">2821676</span>  2b0e2c /home/george/max_workspace/no-OS/projects/adrv902x/build/adrv902x.elf
<span class="o">[</span><span class="m">12</span>:05:21<span class="o">]</span> CreatinMake sure to connect your adrv9002 evaluation board to the correct FMC connector or the carrier you use: g BOOT.BIN and archive with files
<span class="o">[</span><span class="m">12</span>:03:56<span class="o">]</span> Done <span class="o">(</span>build/adrv902x.elf<span class="o">)</span>
</pre></div>
</div>
<p>Make sure to connect your adrv902x evaluation board to the correct FMC connector or the carrier you use before programming it.</p>
<p>Fore more details about the available make rules, check out <a class="reference external" href="https://wiki.analog.com/resources/no-os/make">this page</a>.</p>
</section>
<section id="project-layout-and-hdl-generation">
<h2>Project Layout and HDL Generation<a class="headerlink" href="#project-layout-and-hdl-generation" title="Permalink to this headline">¶</a></h2>
<p>This is how the <a class="reference external" href="https://github.com/analogdevicesinc/no-OS/tree/madura_proj/projects/adrv902x">adrv902x no-OS project</a> looks like as a file tree:</p>
<div class="line-block">
<div class="line">no-OS/projects/adrv902x/</div>
<div class="line">├── Makefile</div>
<div class="line">├── README.rst</div>
<div class="line">├── src</div>
<div class="line">│   ├── common</div>
<div class="line">│   │   ├── ADRV9025_RxGainTable.h</div>
<div class="line">│   │   ├── ADRV9025_TxAttenTable.h</div>
<div class="line">│   │   ├── app_config.h</div>
<div class="line">│   │   ├── common_data.c</div>
<div class="line">│   │   ├── common_data.h</div>
<div class="line">│   │   ├── firmware</div>
<div class="line">│   │   │   ├── ActiveUseCase_profile.h</div>
<div class="line">│   │   │   ├── ActiveUtilInit_profile.h</div>
<div class="line">│   │   │   ├── ADRV9025_DPDCORE_FW.h</div>
<div class="line">│   │   │   ├── ADRV9025_FW.h</div>
<div class="line">│   │   │   └── stream_image_6E3E00EFB74FE7D465FA88A171B81B8F.h</div>
<div class="line">│   │   └── hal</div>
<div class="line">│   │       ├── no_os_platform.c</div>
<div class="line">│   │       └── no_os_platform.h</div>
<div class="line">│   ├── examples</div>
<div class="line">│   │   ├── basic_example</div>
<div class="line">│   │   │   ├── basic_example.c</div>
<div class="line">│   │   │   └── basic_example.h</div>
<div class="line">│   │   ├── dma_example</div>
<div class="line">│   │   │   ├── dma_example.c</div>
<div class="line">│   │   │   └── dma_example.h</div>
<div class="line">│   │   ├── examples_src.mk</div>
<div class="line">│   │   └── iio_example</div>
<div class="line">│   │       ├── iio_example.c</div>
<div class="line">│   │       └── iio_example.h</div>
<div class="line">│   ├── LICENSE_API</div>
<div class="line">│   ├── LICENSE_FW</div>
<div class="line">│   └── platform</div>
<div class="line">│       ├── platform_includes.h</div>
<div class="line">│       └── xilinx</div>
<div class="line">│           ├── main.c</div>
<div class="line">│           ├── parameters.c</div>
<div class="line">│           ├── parameters.h</div>
<div class="line">│           └── platform_src.mk</div>
<div class="line">├── src.mk</div>
<div class="line">└── system_top.xsa</div>
</div>
<p>Note the presence of the system_top.xsa. In order to build this <a class="reference external" href="https://wiki.analog.com/resources/no-os">no-OS</a> project, you need such an .xsa file present in the project directory, as shown above. In case you don’t have one, either obtain a pre-built file or build it yourself by following the <a class="reference external" href="https://wiki.analog.com/resources/fpga/docs/build">Building HDL guide</a>.</p>
<p>And this is how the corresponding <a class="reference external" href="https://github.com/analogdevicesinc/no-OS/tree/master/drivers/rf-transceiver/madura">drivers section</a> looks like as a file tree (the Madura API can be found under common and devices directories):</p>
<div class="line-block">
<div class="line">no-OS/drivers/rf-transceiver/madura/</div>
<div class="line">├── adrv9025.c</div>
<div class="line">├── adrv9025_conv.c</div>
<div class="line">├── adrv9025.c.orig</div>
<div class="line">├── adrv9025.h</div>
<div class="line">├── common</div>
<div class="line">│   ├── adi_common.h</div>
<div class="line">│   ├── adi_common_macros.h</div>
<div class="line">│   ├── adi_common_types.h</div>
<div class="line">│   ├── adi_common_user.h</div>
<div class="line">│   ├── adi_error</div>
<div class="line">│   ├── adi_halMake sure to connect your adrv9002 evaluation board to the correct FMC connector or the carrier you use:</div>
<div class="line">│   └── adi_logging</div>
<div class="line">├── devices</div>
<div class="line">│   └── adrv9025</div>
<div class="line">└── platforms</div>
<div class="line-block">
<div class="line">├── adi_platform.h</div>
<div class="line">└── adi_platform_types.h</div>
</div>
</div>
</section>
<section id="demo-applications">
<h2>Demo Applications<a class="headerlink" href="#demo-applications" title="Permalink to this headline">¶</a></h2>
<p>The demo applications highlight the functionality of the adrv902x evaluation board. Three examples are provided in the sample project:</p>
<ul class="simple">
<li><p>Basic Example</p></li>
<li><p>DMA Example</p></li>
<li><p>IIO Example</p></li>
</ul>
<p>An example is selected by specifying <code class="docutils literal notranslate"><span class="pre">y</span></code> as the value of the corresponding variable in the project Makefile. Below is an example for activating the basic example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">BASIC_EXAMPLE</span> <span class="o">=</span> y
<span class="nv">DMA_EXAMPLE</span> <span class="o">=</span> n
<span class="nv">IIO_EXAMPLE</span> <span class="o">=</span> n
</pre></div>
</div>
<p>Another way of selecting a demo is by passing variables to <code class="docutils literal notranslate"><span class="pre">make</span></code> through command line arguments:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">DMA_EXAMPLE</span><span class="o">=</span>y <span class="nv">IIO_EXAMPLE</span><span class="o">=</span>n
</pre></div>
</div>
<p>Note that only one example can be enabled at a time. Therefore, when using command line arguments, the settings in the Makefile should be taken into account. The command line overwrites the values in the Makefile.</p>
<section id="basic-example">
<h3>Basic Example<a class="headerlink" href="#basic-example" title="Permalink to this headline">¶</a></h3>
<p>The basic example simply initializes the components on the evaluation board and enables a JESD link. Tx will transmit a DDS waveform with the default parameters set by the DAC driver. The output looks like the one below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>adrv9025-phy Rev <span class="m">0</span>, API version: <span class="m">6</span>.4.0.14 found
tx_adxcvr: OK <span class="o">(</span><span class="m">9830400</span> kHz<span class="o">)</span>
rx_adxcvr: OK <span class="o">(</span><span class="m">9830400</span> kHz<span class="o">)</span>
adrv9025-phy Rev <span class="m">176</span>, Firmware <span class="m">6</span>.4.0.6 API version: <span class="m">6</span>.4.0.14 Stream version: <span class="m">9</span>.4.0.1 successfully initialized via jesd204-fsm
tx_jesd status:
    Link is enabled
    Measured Link Clock: <span class="m">245</span>.778 MHz
    Reported Link Clock: <span class="m">245</span>.760 MHz
    Lane rate: <span class="m">9830</span>.400 MHz
    Lane rate / <span class="m">40</span>: <span class="m">245</span>.760 MHz
    LMFC rate: <span class="m">7</span>.680 MHz
    SYNC~: deasserted
    Link status: DATA
    SYSREF captured: Yes
    SYSREF alignment error: No
rx_jesd status:
    Link is enabled
    Measured Link Clock: <span class="m">245</span>.778 MHz
    Reported Link Clock: <span class="m">245</span>.760 MHz
    Lane rate: <span class="m">9830</span>.400 MHz
    Lane rate / <span class="m">40</span>: <span class="m">245</span>.760 MHz
    LMFC rate: <span class="m">7</span>.680 MHz
    Link status: DATA
    SYSREF captured: Yes
    SYSREF alignment error: No
Bye
</pre></div>
</div>
</section>
<section id="dma-example">
<h3>DMA Example<a class="headerlink" href="#dma-example" title="Permalink to this headline">¶</a></h3>
<p>DMA example is a standard example that sends a sinewave on Tx channels using DMA from a lookup table. If you physically loopback a Tx channel to an Rx channel via an electrical wire, you may run the DMA_EXAMPLE and read the received data at Rx from its particular memory address.</p>
<p>Select the example through command line arguments as below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">BASIC_EXAMPLE</span><span class="o">=</span>n <span class="nv">DMA_EXAMPLE</span><span class="o">=</span>y <span class="nv">IIO_EXAMPLE</span><span class="o">=</span>n
</pre></div>
</div>
<p>To run the DMA example, you simply need to run the application as usual by:</p>
<ul class="simple">
<li><p>making sure it was built with the <code class="docutils literal notranslate"><span class="pre">DMA_EXAMPLE</span></code> flag (<code class="docutils literal notranslate"><span class="pre">DMA_EXAMPLE</span> <span class="pre">=</span> <span class="pre">y</span></code> in the Makefile or as command line argument for <code class="docutils literal notranslate"><span class="pre">make</span></code>), as already mentioned</p></li>
<li><p>monitoring the serial terminal for messages printed by the application</p></li>
</ul>
<p>After the output from the basic example, the application will eventually print something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>DMA_EXAMPLE Tx: <span class="nv">address</span><span class="o">=</span>0x1dc900 <span class="nv">samples</span><span class="o">=</span><span class="m">8192</span> <span class="nv">channels</span><span class="o">=</span><span class="m">8</span> <span class="nv">bits</span><span class="o">=</span><span class="m">32</span>
DMA_EXAMPLE Rx: <span class="nv">address</span><span class="o">=</span>0x1e4900 <span class="nv">samples</span><span class="o">=</span><span class="m">65536</span> <span class="nv">channels</span><span class="o">=</span><span class="m">8</span> <span class="nv">bits</span><span class="o">=</span><span class="m">16</span>
</pre></div>
</div>
<p>This means that the memory address where the data at Rx is stored is <code class="docutils literal notranslate"><span class="pre">0x1e4900</span></code>. There are a total of 65536 samples, 16-bit wide across 8 channels, which is equivalent to 8192, 16-bit samples per channel. The location of the transmitted data is also given (0x1dc900).</p>
<p>At this point you may use a Tcl script to retrieve data from memory and store it into .csv files for processing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xsct tools/scripts/platform/xilinx/capture.tcl ZYNQ_PSU 0x1e4900 <span class="m">65536</span> <span class="m">8</span> <span class="m">16</span>
</pre></div>
</div>
<p>You can find more information about  the data <a class="reference external" href="https://wiki.analog.com/resources/no-os/dac_dma_example">here</a>.</p>
<p>The data in the .csv files generated can be visualised using the <a class="reference external" href="https://github.com/analogdevicesinc/no-OS/blob/master/tools/scripts/platform/xilinx/plot.py">plot.py</a> script in the <a class="reference external" href="https://github.com/analogdevicesinc/no-OS/tree/master">no-OS repository</a>. The following command will display the data on all 8 channels:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python do_graph.py <span class="m">8</span>
</pre></div>
</div>
</section>
<section id="iio-example">
<h3>IIO Example<a class="headerlink" href="#iio-example" title="Permalink to this headline">¶</a></h3>
<p>IIO demo is a standard example, provided in most <a class="reference external" href="https://github.com/analogdevicesinc/no-OS/tree/master/projects">no-OS projects</a>, that launches a TINYIIOD server on the board so that the user may connect to it via an IIO client. Using iio-oscilloscope, the user can configure the DAC and view the ADC data on a plot.</p>
<p>To build the TINYIIOD demo, add the following flags when invoking make which will build the TINYIIOD server and the IIO section of the driver:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">BASIC_EXAMPLE</span><span class="o">=</span>n <span class="nv">DMA_EXAMPLE</span><span class="o">=</span>n <span class="nv">IIO_EXAMPLE</span><span class="o">=</span>y
</pre></div>
</div>
<p>To run the TINYIIOD demo, first connect to the board via UART to see the runtime output messages with the following settings:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Baud Rate: 115200bps
Data: <span class="m">8</span> bit
Parity: None
Stop bits: <span class="m">1</span> bit
Flow Control: none
</pre></div>
</div>
<p>Please note that for proper message display, you may need to convert all LF characters to CRLF, if your serial terminal supports it.</p>
<p>With a serial terminal correctly configured and listening to incoming messages, launch the application (make run or click the debug button in your SDK). Runtime messages specific to the application will apear on your serial terminal screen, and eventually the following message is printed, after the output from the basic example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Running TinyIIOD server...
If successful, you may connect an IIO client application by:
<span class="m">1</span>. Disconnecting the serial terminal you use to view this message.
<span class="m">2</span>. Connecting the IIO client application using the serial backend configured as shown:
    Baudrate: <span class="m">115200</span>
    Data size: <span class="m">8</span> bits
    Parity: none
    Stop bits: <span class="m">1</span>
    Flow control: none
</pre></div>
</div>
<p>This message implies a TINYIIOD server is being run and you may connect to it using a serial-backend enabled <a class="reference external" href="https://github.com/analogdevicesinc/iio-oscilloscope">iio-oscilloscope</a> and with the settings indicated at the serial terminal.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/adi_logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">no-OS</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../drivers_guide.html">no-OS drivers guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drivers_doc.html">no-OS drivers list</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../projects_doc.html">no-OS projects list</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../projects_doc.html#inertial-measurement-units">INERTIAL MEASUREMENT UNITS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../projects_doc.html#rf-transceiver">RF TRANSCEIVER</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to no-OS</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../projects_doc.html">no-OS projects list</a><ul>
      <li>Previous: <a href="eval-adis1657x.html" title="previous chapter">Evaluating the ADIS1657X Family</a></li>
      <li>Next: <a href="../contributing.html" title="next chapter">Contributing to no-OS</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Analog Devices, Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/projects/adrv902x.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>